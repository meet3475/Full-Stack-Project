1)Produce name and cities of all customers with the same rating as Hoffman.

SELECT cname, city FROM customer WHERE rating IN (
SELECT rating FROM customer WHERE cname = 'Hoffman');

-------------------------------------------------------------------------------------------------------------

2)Produce the names and rating of all customers who have above average orders.

SELECT orders.onum, customer.cname, customer.rating
FROM customer
INNER JOIN orders
ON customer.cnum = orders.cnum 
WHERE orders.amt > (																
SELECT AVG(amt) FROM orders);


-------------------------------------------------------------------------------------------------------------

3)All orders that are greater than the average for MAR 10.

SELECT * FROM orders WHERE amt > (
SELECT AVG(amt) FROM orders WHERE odate = '10-MAR-94');


-------------------------------------------------------------------------------------------------------------

4)  Find all customers whose cnum is 1000 above the snum of serres.

SELECT * FROM customer WHERE cnum > (
SELECT snum+1000 FROM salespeople WHERE sname = 'serres');


-------------------------------------------------------------------------------------------------------------

5) Count the customers with rating above San Joseâ€™s average.

SELECT COUNT(cnum) FROM customer WHERE rating > (
SELECT AVG(rating) FROM customer WHERE city='San Jose');

-------------------------------------------------------------------------------------------------------------

6)  Find name and number of salespeople who have more than or a customer.

SELECT snum, sname FROM salespeople WHERE snum IN (
SELECT snum FROM customer
GROUP BY snum
HAVING COUNT(cnum) > 1);


-------------------------------------------------------------------------------------------------------------

7) Find total amount in orders for each salesperson for whom this total is greater than the amount of the   largest order in the order table.

SELECT snum, SUM(amt) FROM orders
GROUP BY snum
HAVING SUM(amt) > (
    SELECT MAX(amt) FROM orders
);


-------------------------------------------------------------------------------------------------------------

8) All orders credited to the same salesperson who services Hoffman.

SELECT * FROM orders WHERE snum IN (
SELECT snum FROM customer WHERE cname='Hoffman');

-------------------------------------------------------------------------------------------------------------
9) Find the sums of the amounts from order table grouped by date, eliminating all those dates where the sum was not at least 2000 above the maximum amount.

SELECT odate, SUM(amt) FROM orders 
GROUP BY odate
HAVING SUM(amt) > (
    SELECT  MAX(amt)+2000 FROM orders
);

-------------------------------------------------------------------------------------------------------------
10) Find salespeople number, name, and city who have multiple customers.

SELECT snum, sname, city FROM salespeople WHERE snum IN (
SELECT snum  FROM customer
GROUP BY snum 
HAVING COUNT(cnum) > 1);