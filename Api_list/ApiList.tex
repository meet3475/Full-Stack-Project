1. Count the total number of active users.

[
    {
    $match: {
            "isActive": true
        }
    },
    {
    $count: 'NoOfActiveUsers'
    }
]


{
    "NoOfActiveUsers": 6
}
--------------------------------------------------------------------------------------------------
2. Find the average age of male and female.

[
    {
    $group: {
      _id: "$gender",
            "AveAge": {
        $avg : "$age"
            }
        }
    }
]


{
    "_id": "Male",
    "AveAge": 28.8
}
{
    "_id": "Female",
    "AveAge": 28.2
}

--------------------------------------------------------------------------------------------------
3. Give the total number of posts by active users.

[
    {
   $match: {
            "isActive": true
        }
    },
    {
    $unwind: {
      path: "$posts",
        }
    },
    {
    $group: {
      _id: "$_id",
            "NoOfPost": {
       $sum : 1
            }
        }
    }
]

{
    "_id": 10,
    "NoOfPost": 2
}
{
    "_id": 1,
    "NoOfPost": 2
}
{
    "_id": 6,
    "NoOfPost": 2
}
{
    "_id": 8,
    "NoOfPost": 2
}
{
    "_id": 4,
    "NoOfPost": 2
}
{
    "_id": 2,
    "NoOfPost": 2
}

--------------------------------------------------------------------------------------------------
4. Count the total number of comments.
[
    {
      $unwind: {
        path: "$posts",
        }
    },
    {
      $unwind: {
        path: "$posts.comments",
        }
    },
    {
      $group: {
        _id: "$_id",
            "NoOfComment": {
         $sum : 1
            }
        }
    },
]


[
    {
      $unwind: {
        path: "$posts",
      }
    },
    {
      $project: {
        "comm" : {
          $size : "$posts.comments"
        }
      }
    },
    {
      $group: {
        _id: "$_id",
       TotalComment: {
         $sum: "$comm"
        }
      }
    }
  ]


  {
    "_id": 1,
    "NoOfComment": 3
}
  {
    "_id": 10,
    "NoOfComment": 3
}
  {
    "_id": 4,
    "NoOfComment": 3
}
  {
    "_id": 3,
    "NoOfComment": 2
}
  {
    "_id": 5,
    "NoOfComment": 2
}
  {
    "_id": 2,
    "NoOfComment": 3
}
  {
    "_id": 7,
    "NoOfComment": 2
}
  {
    "_id": 8,
    "NoOfComment": 3
}
  {
    "_id": 6,
    "NoOfComment": 2
}
  {
    "_id": 9,
    "NoOfComment": 3
}


  [
    {
      $unwind: {
        path: "$posts",
        }
    },
    {
      $unwind: {
        path: "$posts.comments",
        }
    },
    {
     $count: 'noOfComments'
    }
]



[
    {
      $unwind: {
        path: "$posts",
      }
    },
    {
      $project: {
        "comm" : {
          $size : "$posts.comments"
        }
      }
    },
    {
      $group: {
        _id: null,
       TotalComment: {
         $sum: "$comm"
        }
      }
    }
  ]


{
    "noOfComments": 26
}
--------------------------------------------------------------------------------------------------
5. List users and their total likes.
[
    {
      $unwind: {
        path: "$posts",
        }
    },
    {
     $group: {
       _id: "$_id",
            "NoOflikes": {
         $sum: "$posts.likes"
            }
        }
    }
]

  
{
    "_id": 1,
    "NoOflikes": 35
}
  {
    "_id": 10,
    "NoOflikes": 43
}
  {
    "_id": 4,
    "NoOflikes": 42
}
  {
    "_id": 3,
    "NoOflikes": 40
}
  {
    "_id": 5,
    "NoOflikes": 32
}
  {
    "_id": 2,
    "NoOflikes": 35
}
  {
    "_id": 7,
    "NoOflikes": 38
}
  {
    "_id": 8,
    "NoOflikes": 43
}
  {
    "_id": 6,
    "NoOflikes": 47
}
  {
    "_id": 9,
    "NoOflikes": 32
}


[
    {
      $unwind: {
        path: "$posts",
        }
    },
    {
     $group: {
       _id: "$_id",
            "name": {
        $first : "$name"
            },
            "NoOflikes": {
         $sum: "$posts.likes"
            }
        }
    }
]

{
    "_id": 1,
    "name": "John Doe",
    "NoOflikes": 35
} //same as other

--------------------------------------------------------------------------------------------------
6. Find the user name with the maximum likes of posts.

[
  {
    $unwind: {
      path: "$posts",
    }
  },
  {
    $group: {
      _id: "$_id",
      "Name": {
        $first : "$name"
      },
      "TotalLikes": {
        $sum: "$posts.likes"
      }
    }
  },
  {
    $sort: {
      "TotalLikes": -1
    }
  },
  {
    $limit: 1
  }
]


{
  "_id": 6,
  "Name": "Fiona Miller",
  "TotalLikes": 47
}


--------------------------------------------------------------------------------------------------
7. Count the number of active and inactive users.

[
  {
    $group: {
      _id: "$isActive",
      "Active": {
        $first: "$isActive"
      },
     "CountOfActive": {
        $sum: 1
      }
    }
  }
]


{
  "_id": true,
  "Active": true,
  "CountOfActive": 6
}
{
  "_id": false,
  "Active": false,
  "CountOfActive": 4
}



[
  {
    $group: {
      _id: "$isActive",
      "Active": {
        $first: "$isActive"
      },
     "CountOfActive": {
        $sum: 1
      }
    }
  }, 
  {
    $project: {
      _id : 0
    }
  }
]

{
  "Active": true,
  "CountOfActive": 6
}
{
  "Active": false,
  "CountOfActive": 4
}
--------------------------------------------------------------------------------------------------
8. List the cities with the highest average age.

[
  {
    $group: {
      _id: "$city",
      "AvgAge": {
        $avg: "$age"
      }
    }
  },
  {
    $sort: {
      "AvgAge": -1
    }
  }
]


{
  "_id": "Los Angeles",
  "AvgAge": 31
}
{
  "_id": "San Francisco",
  "AvgAge": 28.666666666666668
}
{
  "_id": "Portland",
  "AvgAge": 27
}
{
  "_id": "New York",
  "AvgAge": 26
}


--------------------------------------------------------------------------------------------------
9. Count the number of users in each city.

[
  {
    $group: {
      _id: "$city",
     	"CountOfCity": {
        $sum: 1
      }
    }
  }
]


{
  "_id": "Los Angeles",
  "CountOfCity": 3
}
{
  "_id": "Portland",
  "CountOfCity": 2
}
{
  "_id": "New York",
  "CountOfCity": 2
}
{
  "_id": "San Francisco",
  "CountOfCity": 3
}


--------------------------------------------------------------------------------------------------

10. Count the number of users with JavaScript skills.

[
  {
    $match: {
      "skills" : "JavaScript"
    }
  },
  {
    $count: 'NoOfUser'
  }
  
]

{
  "NoOfUser": 6
}

--------------------------------------------------------------------------------------------------

11. Count the number of users with each skill.

[
  {
    $unwind: {
      path: "$skills",
    }
  },
  {
    $group: {
      _id: "$skills",
      "NoOfuser": {
        $sum: 1
      }
    }
  }
]

{
  "_id": "MongoDB",
  "NoOfuser": 2
}
{
  "_id": "Spring Boot",
  "NoOfuser": 2
}
{
  "_id": "Vue.js",
  "NoOfuser": 2
}
{
  "_id": "Express.js",
  "NoOfuser": 2
}
{
  "_id": "Angular",
  "NoOfuser": 1
}
{
  "_id": "Flask",
  "NoOfuser": 1
}
{
  "_id": "Python",
  "NoOfuser": 2
}
{
  "_id": "Node.js",
  "NoOfuser": 4
}
{
  "_id": "Java",
  "NoOfuser": 2
}
{
  "_id": "JavaScript",
  "NoOfuser": 6
}

--------------------------------------------------------------------------------------------------

12. Find users who have posts with more than 15 likes and a specific skill.

[
  {
    $unwind: {
      path: "$posts"
    }
  },
  {
    $match: {
      $and: [
        {"posts.likes" : {$gt : 15}},
         {"skills" : "React"}
      ]
    }
  }
]




{
  "_id": 1,
  "name": "John Doe",
  "age": 28,
  "city": "New York",
  "gender": "Male",
  "posts": {
    "title": "Post 2",
    "likes": 20,
    "comments": [
      "Well done"
    ]
  },
  "friends": [
    2,
    3
  ],
  "skills": [
    "JavaScript",
    "React",
    "Node.js"
  ],
  "isActive": true
} 
% As it is jema react skill hase te data display

--------------------------------------------------------------------------------------------------

13. Find users with the highest total number of likes across all posts.

[
  {
    $unwind: {
      path: "$posts",
    }
  },
  {
    $sort: {
      "posts.likes": -1
    }
  },
  {
    $limit: 1
  }
]

{
  "_id": 4,
  "name": "Diana Brown",
  "age": 30,
  "city": "San Francisco",
  "gender": "Female",
  "posts": {
    "title": "Post 8",
    "likes": 30,
    "comments": [
      "Well done",
      "Great post!"
    ]
  },
  "friends": [
    5,
    6
  ],
  "skills": [
    "React",
    "Node.js",
    "MongoDB"
  ],
  "isActive": true
}
--------------------------------------------------------------------------------------------------

14. Find users who have friends and count the number of friends.

[
  {
    $match: {
      "friends" : {$exists : true, $ne: []}
    }
  },
  {
    $project: {
      "totalFriends" : {
        $size:"$friends"
      }
    }
  }
]

{
  "_id": 2,
  "totalFriends": 2
}
{
  "_id": 1,
  "totalFriends": 2
}
{
  "_id": 8,
  "totalFriends": 2
}
{
  "_id": 9,
  "totalFriends": 2
}
{
  "_id": 4,
  "totalFriends": 2
}
{
  "_id": 3,
  "totalFriends": 2
}
{
  "_id": 6,
  "totalFriends": 2
}
{
  "_id": 5,
  "totalFriends": 2
}
{
  "_id": 7,
  "totalFriends": 2
}
{
  "_id": 10,
  "totalFriends": 2
}
--------------------------------------------------------------------------------------------------
15. Find users who have at least one post with a specific comment and a specific skill.

[
  {
    $unwind: {
      path: "$posts",
    }
  },
  {
    $match: {
      $and: [
        {"posts.comments" : "Nice!"},
        {"skills" : "JavaScript"}
        
      ]
    }
  }
]

{
  "_id": 2,
  "name": "Alice Johnson",
  "age": 32,
  "city": "Los Angeles",
  "gender": "Female",
  "posts": {
    "title": "Post 3",
    "likes": 10,
    "comments": [
      "Nice!",
      "Awesome"
    ]
  },
  "friends": [
    1,
    3
  ],
  "skills": [
    "Python",
    "Django",
    "JavaScript"
  ],
  "isActive": true
}
% jema commet nice and skill javascript hoy tej display
--------------------------------------------------------------------------------------------------
16. Count users who have skills javascript and react.

[
  {
    $match: {
      "skills": { $all:["JavaScript", "React"] }
    }
  }, 
  {
    $count: 'NoOfReactAndJavascript'
  }
]


{
  "NoOfReactAndJavascript": 4
}



[
  {
    $match: {
      skills : {
        $all : ["JavaScript", "React"]
      }
    }
  },
  {
    $count: 'NoOfUser'
  }
]

{
  "NoOfUser": 4
}
--------------------------------------------------------------------------------------------------
17. count user who have second skills as React

[
  {
    $project: {
      "SecondSkills" : {$arrayElemAt: ["$skills", 1]}
    }
  },
  {
    $match: {
      "SecondSkills" : "React"
    }
  },
  {
    $count: 'NoOfSecondSkillReact'
  }
]


{
  "NoOfSecondSkillReact": 4
}



[
  {
    $match: {
      "skills.1" : "React"
    }
  },
  {
    $count: 'NoOfuser'
  }
]

{
  "NoOfuser": 4
}

--------------------------------------------------------------------------------------------------
18. Categorise users by their city and gives their id and name.

[
  {
    $group: {
      _id: "$city",
      "User": {
        $push:{
					"_id" : "$_id",
          "name" : "$name"
        }
      }
    }
  }
]



{
  "_id": "Los Angeles",
  "User": [
    {
      "_id": 2,
      "name": "Alice Johnson"
    },
    {
      "_id": 5,
      "name": "Elijah Wilson"
    },
    {
      "_id": 7,
      "name": "George Taylor"
    }
  ]
}

{
  "_id": "San Francisco",
  "User": [
    {
      "_id": 8,
      "name": "Hannah Robinson"
    },
    {
      "_id": 4,
      "name": "Diana Brown"
    },
    {
      "_id": 6,
      "name": "Fiona Miller"
    }
  ]
}

{
  "_id": "New York",
  "User": [
    {
      "_id": 1,
      "name": "John Doe"
    },
    {
      "_id": 3,
      "name": "Bob Williams"
    },
    {
      "_id": 11,
      "name": "John Doe"
    },
    {
      "_id": 12,
      "name": "John Doe"
    }
  ]
}

{
  "_id": "Portland",
  "User": [
    {
      "_id": 9,
      "name": "Isaac Moore"
    },
    {
      "_id": 10,
      "name": "Jasmine Hill"
    }
  ]
}


[
  {
    $group: {
      _id: "$city",
      "User": {
        $push: {"id" : "$_id", "name" : "$name"}
      }
    }
  }
]

% same as upar nu output


--------------------------------------------------------------------------------------------------
19. Give user data whose city name starts with "New".

[
  {
    $match: {
      "city" : {$regex:  "New"}
    }
  }
]

{
  "_id": 1,
  "name": "John Doe",
  "age": 28,
  "city": "New York",
  "gender": "Male",
  "posts": [
    {
      "title": "Post 1",
      "likes": 15,
      "comments": [
        "Great post!",
        "Interesting"
      ]
    },
    {
      "title": "Post 2",
      "likes": 20,
      "comments": [
        "Well done"
      ]
    }
  ],
  "friends": [
    2,
    3
  ],
  "skills": [
    "JavaScript",
    "React",
    "Node.js"
  ],
  "isActive": true
}
% as it is jena city ma New start thato hase e j data batavase... [1, 3, 11, 12]



[
  {
    $match: {
      "city" : /^New[a-zA-Z ]{2,30}$/
    }
  }
]
% same as upar nu output

--------------------------------------------------------------------------------------------------
20. Add a "postCount" field representing the total number of posts for each user.

[
  {
    $project: {
      "name" :  1,
      "postCount" : {$size: "$posts"}
    }
  }
]


{
  "_id": 2,
  "name": "Alice Johnson",
  "postCount": 2
}
{
  "_id": 1,
  "name": "John Doe",
  "postCount": 2
}
{
  "_id": 8,
  "name": "Hannah Robinson",
  "postCount": 2
}
{
  "_id": 9,
  "name": "Isaac Moore",
  "postCount": 2
}
{
  "_id": 4,
  "name": "Diana Brown",
  "postCount": 2
}
{
  "_id": 3,
  "name": "Bob Williams",
  "postCount": 2
}
{
  "_id": 6,
  "name": "Fiona Miller",
  "postCount": 2
}
{
  "_id": 5,
  "name": "Elijah Wilson",
  "postCount": 2
}
{
  "_id": 7,
  "name": "George Taylor",
  "postCount": 2
}
{
  "_id": 10,
  "name": "Jasmine Hill",
  "postCount": 2
}


[
  {
    $addFields: {
      "postCount": {$size: "$posts"}
    }
  },
  {
    $project: {
      "name" : 1,
      "postCount" : 1
    }
  }
]

% same as upar nu output
--------------------------------------------------------------------------------------------------
21. Add a "friendNames" field with the names of friends for each user.

[
  {
    $lookup: {
      from: "Users",
      localField: "friends",
      foreignField: "_id",
      as: "friendNames"
    }
  },
  {
    $project: {
      "name": 1,
      "friendNames.name" : 1
    }
  }
]

{
  "_id": 1,
  "name": "John Doe",
  "friendNames": []
}
% as it is baki badha ma friendNames field add thay jase..



[
  {
    $lookup: {
      from: "users",
      localField: "friends",
      foreignField: "_id",
      as: "friendsName"
    }
  },
  {
    $project: {
      "name": 1,
      "friendsName.name": 1
    }
  }
]

% same as upar nu output

--------------------------------------------------------------------------------------------------
22. Display posts data that have more than 1 comments.

[
  {
    $unwind: {
      path: "$posts"
    }
  },
  {
    $project: {
      "posts" : 1,
      "CountComment" : {$size : "$posts.comments"}
    }
  },
  {
    $match: {
      "CountComment" : {$gt : 1}
    }
  }
]


{
  "_id": 2,
  "posts": {
    "title": "Post 3",
    "likes": 10,
    "comments": [
      "Nice!",
      "Awesome"
    ]
  },
  "CountComment": 2
}
{
  "_id": 1,
  "posts": {
    "title": "Post 1",
    "likes": 15,
    "comments": [
      "Great post!",
      "Interesting"
    ]
  },
  "CountComment": 2
}
{
  "_id": 8,
  "posts": {
    "title": "Post 15",
    "likes": 15,
    "comments": [
      "Nice!",
      "Interesting"
    ]
  },
  "CountComment": 2
}
{
  "_id": 9,
  "posts": {
    "title": "Post 17",
    "likes": 10,
    "comments": [
      "Nice!",
      "Impressive"
    ]
  },
  "CountComment": 2
}
{
  "_id": 4,
  "posts": {
    "title": "Post 8",
    "likes": 30,
    "comments": [
      "Well done",
      "Great post!"
    ]
  },
  "CountComment": 2
}
{
  "_id": 10,
  "posts": {
    "title": "Post 19",
    "likes": 18,
    "comments": [
      "Keep it up",
      "Awesome"
    ]
  },
  "CountComment": 2
}
{
  "_id": 11,
  "posts": {
    "title": "Post 1",
    "likes": 15,
    "comments": [
      "Great post!",
      "Interesting"
    ]
  },
  "CountComment": 2
}
{
  "_id": 12,
  "posts": {
    "title": "Post 1",
    "likes": 15,
    "comments": [
      "Great post!",
      "Interesting"
    ]
  },
  "CountComment": 2
}




[
  {
    $unwind: {
      path: "$posts",
    }
  },
  {
    $addFields: {
      "UserComment": {$size : "$posts.comments"}
    }
  },
  {
    $match: {
       "UserComment" : {$gt: 1}
    }
  },
  {
    $project: {
      	name : 1,
      	"UserComment": 1
    }
  }
]


{
  "_id": 2,
  "name": "Alice Johnson",
  "UserComment": 2
}
{
  "_id": 1,
  "name": "John Doe",
  "UserComment": 2
}
{
  "_id": 8,
  "name": "Hannah Robinson",
  "UserComment": 2
}
{
  "_id": 9,
  "name": "Isaac Moore",
  "UserComment": 2
}
{
  "_id": 4,
  "name": "Diana Brown",
  "UserComment": 2
}
{
  "_id": 10,
  "name": "Jasmine Hill",
  "UserComment": 2
}
{
  "_id": 11,
  "name": "John Doe",
  "UserComment": 2
}
{
  "_id": 12,
  "name": "John Doe",
  "UserComment": 2
}
--------------------------------------------------------------------------------------------------